const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip.min-HSauquch.js","assets/index-Bsw7IWg8.js","assets/index-BxHXjSsu.css"])))=>i.map(i=>d[i]);
import{g as O,h as G,r as m,l as B,n as P,L as w,_ as c,k as i,s as R,j as A,t as k,d as nt,E as it,b as rt,i as q,v as T,F as lt,G as j,H as ct,J as Z,K,M as dt,x as _,D as pt,y as mt,z as ut,N as ft,O as gt,I as yt,P as bt,S as xt}from"./index-Bsw7IWg8.js";import{B as H}from"./Button-DEmXe1_d.js";function vt(t){return G("MuiListItem",t)}const L=O("MuiListItem",["root","container","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","padding","button","secondaryAction","selected"]),It=O("MuiListItemButton",["root","focusVisible","dense","alignItemsFlexStart","disabled","divider","gutters","selected"]);function ht(t){return G("MuiListItemSecondaryAction",t)}O("MuiListItemSecondaryAction",["root","disableGutters"]);const Ct=["className"],Lt=t=>{const{disableGutters:e,classes:s}=t;return k({root:["root",e&&"disableGutters"]},ht,s)},wt=R("div",{name:"MuiListItemSecondaryAction",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.root,s.disableGutters&&e.disableGutters]}})(({ownerState:t})=>c({position:"absolute",right:16,top:"50%",transform:"translateY(-50%)"},t.disableGutters&&{right:0})),Y=m.forwardRef(function(e,s){const o=B({props:e,name:"MuiListItemSecondaryAction"}),{className:n}=o,r=P(o,Ct),l=m.useContext(w),a=c({},o,{disableGutters:l.disableGutters}),d=Lt(a);return i.jsx(wt,c({className:A(d.root,n),ownerState:a,ref:s},r))});Y.muiName="ListItemSecondaryAction";const At=["className"],$t=["alignItems","autoFocus","button","children","className","component","components","componentsProps","ContainerComponent","ContainerProps","dense","disabled","disableGutters","disablePadding","divider","focusVisibleClassName","secondaryAction","selected","slotProps","slots"],St=(t,e)=>{const{ownerState:s}=t;return[e.root,s.dense&&e.dense,s.alignItems==="flex-start"&&e.alignItemsFlexStart,s.divider&&e.divider,!s.disableGutters&&e.gutters,!s.disablePadding&&e.padding,s.button&&e.button,s.hasSecondaryAction&&e.secondaryAction]},jt=t=>{const{alignItems:e,button:s,classes:o,dense:n,disabled:r,disableGutters:l,disablePadding:a,divider:d,hasSecondaryAction:p,selected:u}=t;return k({root:["root",n&&"dense",!l&&"gutters",!a&&"padding",d&&"divider",r&&"disabled",s&&"button",e==="flex-start"&&"alignItemsFlexStart",p&&"secondaryAction",u&&"selected"],container:["container"]},vt,o)},Pt=R("div",{name:"MuiListItem",slot:"Root",overridesResolver:St})(({theme:t,ownerState:e})=>c({display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left"},!e.disablePadding&&c({paddingTop:8,paddingBottom:8},e.dense&&{paddingTop:4,paddingBottom:4},!e.disableGutters&&{paddingLeft:16,paddingRight:16},!!e.secondaryAction&&{paddingRight:48}),!!e.secondaryAction&&{[`& > .${It.root}`]:{paddingRight:48}},{[`&.${L.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${L.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:T.alpha(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${L.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:T.alpha(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${L.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity}},e.alignItems==="flex-start"&&{alignItems:"flex-start"},e.divider&&{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"},e.button&&{transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${L.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:T.alpha(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:T.alpha(t.palette.primary.main,t.palette.action.selectedOpacity)}}},e.hasSecondaryAction&&{paddingRight:48})),Rt=R("li",{name:"MuiListItem",slot:"Container",overridesResolver:(t,e)=>e.container})({position:"relative"}),Nt=m.forwardRef(function(e,s){const o=B({props:e,name:"MuiListItem"}),{alignItems:n="center",autoFocus:r=!1,button:l=!1,children:a,className:d,component:p,components:u={},componentsProps:y={},ContainerComponent:v="li",ContainerProps:{className:I}={},dense:f=!1,disabled:g=!1,disableGutters:h=!1,disablePadding:$=!1,divider:Q=!1,focusVisibleClassName:X,secondaryAction:U,selected:tt=!1,slotProps:et={},slots:st={}}=o,ot=P(o.ContainerProps,At),at=P(o,$t),z=m.useContext(w),D=m.useMemo(()=>({dense:f||z.dense||!1,alignItems:n,disableGutters:h}),[n,z.dense,f,h]),F=m.useRef(null);nt(()=>{r&&F.current&&F.current.focus()},[r]);const C=m.Children.toArray(a),E=C.length&&it(C[C.length-1],["ListItemSecondaryAction"]),N=c({},o,{alignItems:n,autoFocus:r,button:l,dense:D.dense,disabled:g,disableGutters:h,disablePadding:$,divider:Q,hasSecondaryAction:E,selected:tt}),V=jt(N),W=rt(F,s),M=st.root||u.Root||Pt,S=et.root||y.root||{},b=c({className:A(V.root,S.className,d),disabled:g},at);let x=p||"li";return l&&(b.component=p||"div",b.focusVisibleClassName=A(L.focusVisible,X),x=lt),E?(x=!b.component&&!p?"div":x,v==="li"&&(x==="li"?x="div":b.component==="li"&&(b.component="div")),i.jsx(w.Provider,{value:D,children:i.jsxs(Rt,c({as:v,className:A(V.container,I),ref:W,ownerState:N},ot,{children:[i.jsx(M,c({},S,!q(M)&&{as:x,ownerState:c({},N,S.ownerState)},b,{children:C})),C.pop()]}))})):i.jsx(w.Provider,{value:D,children:i.jsxs(M,c({},S,{as:x,ref:W},!q(M)&&{ownerState:c({},N,S.ownerState)},b,{children:[C,U&&i.jsx(Y,{children:U})]}))})});function Mt(t){return G("MuiListItemAvatar",t)}O("MuiListItemAvatar",["root","alignItemsFlexStart"]);const Tt=["className"],Ot=t=>{const{alignItems:e,classes:s}=t;return k({root:["root",e==="flex-start"&&"alignItemsFlexStart"]},Mt,s)},Bt=R("div",{name:"MuiListItemAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[e.root,s.alignItems==="flex-start"&&e.alignItemsFlexStart]}})(({ownerState:t})=>c({minWidth:56,flexShrink:0},t.alignItems==="flex-start"&&{marginTop:8})),kt=m.forwardRef(function(e,s){const o=B({props:e,name:"MuiListItemAvatar"}),{className:n}=o,r=P(o,Tt),l=m.useContext(w),a=c({},o,{alignItems:l.alignItems}),d=Ot(a);return i.jsx(Bt,c({className:A(d.root,n),ownerState:a,ref:s},r))}),Dt=["children","className","disableTypography","inset","primary","primaryTypographyProps","secondary","secondaryTypographyProps"],Ft=t=>{const{classes:e,inset:s,primary:o,secondary:n,dense:r}=t;return k({root:["root",s&&"inset",r&&"dense",o&&n&&"multiline"],primary:["primary"],secondary:["secondary"]},ct,e)},_t=R("div",{name:"MuiListItemText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:s}=t;return[{[`& .${Z.primary}`]:e.primary},{[`& .${Z.secondary}`]:e.secondary},e.root,s.inset&&e.inset,s.primary&&s.secondary&&e.multiline,s.dense&&e.dense]}})(({ownerState:t})=>c({flex:"1 1 auto",minWidth:0,marginTop:4,marginBottom:4},t.primary&&t.secondary&&{marginTop:6,marginBottom:6},t.inset&&{paddingLeft:56})),Gt=m.forwardRef(function(e,s){const o=B({props:e,name:"MuiListItemText"}),{children:n,className:r,disableTypography:l=!1,inset:a=!1,primary:d,primaryTypographyProps:p,secondary:u,secondaryTypographyProps:y}=o,v=P(o,Dt),{dense:I}=m.useContext(w);let f=d??n,g=u;const h=c({},o,{disableTypography:l,inset:a,primary:!!f,secondary:!!g,dense:I}),$=Ft(h);return f!=null&&f.type!==j&&!l&&(f=i.jsx(j,c({variant:I?"body2":"body1",className:$.primary,component:p!=null&&p.variant?void 0:"span",display:"block"},p,{children:f}))),g!=null&&g.type!==j&&!l&&(g=i.jsx(j,c({variant:"body2",className:$.secondary,color:"text.secondary",display:"block"},y,{children:g}))),i.jsxs(_t,c({className:A($.root,r),ownerState:h,ref:s},v,{children:[f,g]}))}),J=async(t,e,s)=>{const o=await createImageBitmap(t),n=document.createElement("canvas");return n.width=o.width,n.height=o.height,n.getContext("2d").drawImage(o,0,0),new Promise(r=>n.toBlob(l=>r({blob:l,size:l.size,url:URL.createObjectURL(l)}),`image/${e}`,s))},Ut=async(t,e)=>{let s;t instanceof Blob?s=t:s=await(await fetch(t)).blob(),K.saveAs(s,e)},zt=async t=>{const{default:e}=await dt(async()=>{const{default:n}=await import("./jszip.min-HSauquch.js").then(r=>r.j);return{default:n}},__vite__mapDeps([0,1,2])),s=new e;for(const{blob:n,name:r}of t){const l=n instanceof Blob?n:await(await fetch(n)).blob();s.file(r,l)}const o=await s.generateAsync({type:"blob"});K.saveAs(o,"shinobi.zip")};function Wt(){const t=_(a=>a.downloadModalOpen),e=()=>_.setState({downloadModalOpen:!1}),{items:s,selected:o,global:n}=_.getState(),r=o.size?s.filter(a=>o.has(a.id)):s,l=async()=>{const a=["png","jpeg","webp"],d=[];for(const p of r)for(const u of a){const y=p.q??n.q,{blob:v}=await J(p.file,u,y),I=(p.customName||p.name).replace(/\.[^/.]+$/,"");d.push({blob:v,name:`${I}.${u}`})}zt(d)};return i.jsxs(pt,{open:t,onClose:e,fullWidth:!0,maxWidth:"sm",role:"dialog","aria-labelledby":"download-dialog-title",children:[i.jsx(mt,{id:"download-dialog-title",children:"Download"}),i.jsx(ut,{children:r.length>0?i.jsxs(i.Fragment,{children:[i.jsx(ft,{"aria-label":"Files to download",sx:{maxHeight:300,overflowY:"auto"},children:r.map(a=>{const d=a.customName||a.name;return i.jsxs(Nt,{secondaryAction:i.jsx(yt,{"aria-label":`Download ${d}`,onClick:async()=>{const p=a.formats[0],u=a.q??n.q,{blob:y}=await J(a.file,p,u);Ut(y,`${d.replace(/\.[^/.]+$/,"")}.${p}`)},children:i.jsx(bt,{})}),children:[i.jsx(kt,{children:i.jsx(gt,{src:a.urlC??a.url})}),i.jsx(Gt,{primary:d,secondary:`${((a.sizeO??0)/1024).toFixed(1)} KB → ${((a.sizeC??a.sizeO??0)/1024).toFixed(1)} KB`})]},a.id)})}),i.jsxs(xt,{direction:{xs:"column",sm:"row"},spacing:1,mt:2,children:[i.jsx(H,{"aria-label":"Download ZIP of selected files",variant:"contained",fullWidth:!0,onClick:l,children:"Download ZIP"}),i.jsx(H,{"aria-label":"Download each file in all formats",variant:"outlined",fullWidth:!0,onClick:l,children:"Download in all formats"})]})]}):i.jsx(j,{children:"No files to download"})})]})}export{Wt as default};
